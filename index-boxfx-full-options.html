<!--
// Guess what ? that a Work In Progress ! Amazing W0oT ? by @molokoloco - 2011
// All sources on GitHub : https://github.com/molokoloco/ Take it, smash it ;)
-->
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="content-language" content="fr"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>BoxFx particules factory with jQuery & CSS3 V0.8</title>
    <meta name="description" content="" />
    <meta name="author" content="Remixed by @molokoloco 2011 - http://b2bweb.fr" />
    <meta name="viewport" content="width=720" />
    <link href="./css/index.css" rel="stylesheet" type="text/css">
    <style type="text/css">

    /* ---- BoxFx #1 ---- */

    div#boxFxZone1 {
        position:relative; /* particule seeds childs are abs. positionned inside */
        width:500px;
        height:300px;
        background:#333333; /* Solid color for perfs */
        border:1px solid black;
        overflow:hidden; /* Crop particule visibility inside box ? */
    }

    </style>
    <!-- modernizr first JS to load -->
    <script src="./js/modernizr.min.js" type="text/javascript"></script>

    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>

    <div id="page">
        <p>
           jQuery <strong>boxFx</strong> factory of &quot;seeds&quot; with CSS3 animations/transitions<br />
           Clash the DOM with the most optimized jQuery plugin on earth ^^
        </p>

        <div id="boxFxZone1">
            <!--// Here come the Seeds //-->
        </div>

        <p style="text-align:right">
            <a href="javascript:void(0);" id="start">Start</a> |
            <a href="javascript:void(0);" id="stop">Stop</a> |
            <a href="javascript:void(0);" id="reset" title="Clear elements cache">Reset</a>
        </p>

        <p id="presets" class="tips">
            <!--// Here come the effects presets (cf. bottom of this page) (demo) //-->
        <p>

        <p>Live edit funny boxFx plugin properties !<p>

        <div id="edit">
            <!--// Here come the Editor (demo) //-->
        </div>

         <p class="tips">
             <strong>Tips :</strong><br />
             When working with 'options.keyframes', 'options.styles2Class:true'<br />
             or Templates (Seed/target HTML) : Press &quot;Reset&quot; and after &quot; Start&quot; buttons<br />
             Add your properties, set unwanted existing ones to "null" (live editor constrain)<br />
             <em>gradient</em>, <em>boxShadow</em>, <em>opacity</em>, <em>borderRadius</em>... are CPU consumming<br />
             <br />
             As i said : <em>Kill your own PC before killing the ones of your visitors</em><br />
             That a good &quot;STRECSS case&quot; plugin if you overload settings... ^^<br />
             <br />
             Some properties, like functions, do not render in the JSON export you see here, go to the presets file for more information : <a href="./js/jquery.boxFx.presets.js" target="blank"><strong>./js/jquery.boxFx.presets.js</strong></a><br />
             <br />
             Questions something to share ? <a href="mailto:molokoloco@gmail.com" id="pause">Contact me</a> ? Send yours effects<br />
             <a href="https://github.com/molokoloco/jquery.boxFx" target="_blank">Fork it</a> and get updated on GitHub
        </p>
    </div>

    <a href="https://github.com/molokoloco/jquery.boxFx" target="_blank" title="Fork me on GitHub" class="ribbon">
        <img src="http://www.b2bweb.fr/bonus/jx/images/github-ribbon.png" alt="GitHub" width="100" height="100">
    </a>

    <div class="spacer"></div>
    
    -DISCUSS ?-

    <!-- jQuery -->
    <script src="http://code.jquery.com/jquery-1.5.2.min.js" type="text/javascript"></script>
    <!-- BoxFx Plugin + tools dependancy : ".min.js" for minimified version -->
    <script src="./js/jquery.boxFx.tools.js" type="text/javascript"></script>
    <script src="./js/jquery.boxFx.js" type="text/javascript"></script>
    <!-- For the demo, full options example presets -->
    <script src="./js/jquery.boxFx.presets-full-options.js" type="text/javascript"></script>
    <script type="text/javascript">

$(document).ready(function(){ // PAGE DOM READY, CUSTOM SCRIPT EXAMPLE

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // jQuery boxFx ANIMATION factory (CSS3 keyframe & transitions)
    // V0.9 - @molokoloco 2011 - http://b2bweb.fr
    // Check comments in source code of "./js/jquery.boxFx.mlklc.js"
    // Or go to : http://www.b2bweb.fr/molokoloco/boxFx-seeds-particules-factory-with-jquery-css3/
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    // Some optionnals "options presets"...
    var optionsPresets = window.optionsPresets || {}; // import from ./js/jquery.boxFx.presets-full-options.js

    // APPLY effect !
    var $boxFx1 = $('div#boxFxZone1').boxFx(optionsPresets.boxFxFullOptions);

    // Links to control boxFx
    $('a#start,a#stop,a#reset').click(function() {
        $boxFx1.trigger(this.id); // Send orders to plugin : start/stop/reset...
    });

    // Et voil√† :)

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Catch new Seed emit event and display stats (only for the demo)
    // Inspired from https://github.com/mrdoob/stats.js
    var now = Date.now(),
        T = {frames:0, time:now, timeLastSecond:now, fps:0},
        $stats = $('<div id="sps" title="Seeds/Seconds"></div>').appendTo($boxFx1);

    // Bind our emittor emit event
    $boxFx1.bind('emit', function(e, $seed) {
        T.time = Date.now();
        T.frames ++;
        if (T.time > T.timeLastSecond + 1000) {
            T.fps = Math.round((T.frames * 1000) / (T.time - T.timeLastSecond));
            $stats.html(T.fps+'s/sec');
            T.timeLastSecond = T.time;
            T.frames = 0;
        }
    });

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Example : Move the boxFxCenter, when mouse is over
    /*
    var offset = $boxFx1.offset(),
        mouseIsMove = function(evt) {
            $boxFx1.trigger('update', [{ // Pass data through event callback
                emitterCenterLeft : evt.pageX - offset.left,
                emitterCenterTop : evt.pageY - offset.top
            }]);
        },
        mouseIsEnter = function(evt) {
            $boxFx1.bind('mousemove', mouseIsMove);
        },
        mouseIsLeave = function(evt) {
            $boxFx1.unbind('mousemove', mouseIsMove);
            $boxFx1.trigger('update', [{ // Reset
                emitterCenterLeft : parseInt($boxFx1.width(), 10) / 2,
                emitterCenterTop : parseInt($boxFx1.height(), 10) / 2
            }]);
        };

    $boxFx1.bind({
        mouseenter:mouseIsEnter,
        mouseleave:mouseIsLeave
    });
    */

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // EMITTER LIVE EDITOR (only for the demo) ////////////////////////////////////////////////////////
    // JSON.parse - http://jsfiddle.net/molokoloco/rSMLU/

    var getQ = function(o) { return (o && typeof o == 'string' ? '\'' : ''); }, // Get Quotes '
        obj2Json = function(_options) { // Convert "options" js Object to string
            var txt = '';
            if (JSON !== 'undefined') txt = JSON.stringify(_options, null, 4);
            else {
                for (var k in _options) { // don't catch key:null as sub-obj
                    if (typeof _options[k] == 'object' && _options[k] !== null) { // Level 2 array ?
                        txt += '\t'+k+': {\n';
                        for (var j in _options[k])
                            txt += '\t\t'+j+': '+getQ(_options[k][j])+_options[k][j]+getQ(_options[k][j])+',\n';
                        txt = txt.substr(0, txt.length - 2)+'\n';
                        txt += '\t},\n';
                    }
                    else txt += '\t'+k+': '+getQ(_options[k])+_options[k]+getQ(_options[k])+',\n';
                }
                txt = '{\n'+txt.substr(0, txt.length - 2)+'\n}';
            }
            return txt;
        },
        textareaUpdateBoxFx = function(event) {
            var val = $.trim($(this).val());
            if (!val) return;
            var liveOptions = $.parseJSON(val); // prefer jQUery instead of window.JSON.parse()
            if (!liveOptions) db('Parsing error', e);
            else $boxFx1.trigger('update', [liveOptions]);
        },
        buttonsClickSetOptions = function(event) {
            event.preventDefault();
            var effect = this.id.substr(4); // 'btn_' + name
            if (optionsPresets[effect]) {
                $('a.button.selected').removeClass('selected');
                $(this).addClass('selected');
                $editor.val(obj2Json(optionsPresets[effect]));
                $boxFx1.trigger('setOptions', [optionsPresets[effect]]);
                window.location.hash = effect; // Update browser, give link for the effect
            }
            return false;
        };

    // Append Editor with current option as text
    $editor = $('<textarea id="options" spellcheck="false">'+obj2Json(effect)+'</textarea>')
        .bind('keyup', textareaUpdateBoxFx)
        .appendTo('div#edit');

    // Create buttons for all our PRESETS
    var btnHtml = [];
    for(var k in optionsPresets)
        btnHtml.push('<a id="btn_'+k+'" href="javascript:void(0);" class="button">'+k+'</a>'); // 'a.button'
    $('p#presets').html('Effects presets : '+btnHtml.join(', '));
    $('body').delegate('a.button', 'click', buttonsClickSetOptions);

});
</script>
</body>